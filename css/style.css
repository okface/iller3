:root {
  --bg: #f6f4fb;
  --bg-alt: #ffffff;
  --border: #e3def3;
  --text: #2d2540;
  --text-dim: #5f5575;
  --accent: #6f3ef4;
  --accent-glow: 210 90% 60%;
  --accent-soft: #ede7ff;
  --danger: #c2363b;
  --radius-s: 6px;
  --radius-m: 14px;
  --radius-l: 28px;
  --shadow: 0 2px 4px -1px rgba(60,40,120,.12), 0 4px 18px -2px rgba(60,40,120,.08);
  color-scheme: light;
}
* { box-sizing: border-box; }
html,body { margin:0; padding:0; font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,sans-serif; background: var(--bg); color: var(--text); -webkit-font-smoothing: antialiased; }
body { min-height:100dvh; display:flex; flex-direction:column; }
img { max-width:100%; display:block; }

.app-header { position:sticky; top:0; backdrop-filter:saturate(180%) blur(14px); background:rgba(246,244,251,0.92); padding:.6rem .9rem; display:flex; align-items:center; gap:.75rem; border-bottom:1px solid var(--border); z-index:10; }
.logo { font-weight:600; display:flex; align-items:center; gap:.5rem; font-size:1.05rem; }
.logo img { width:34px; height:34px; }
.icon-btn { background:var(--accent-soft); color:var(--accent); border:1px solid var(--border); border-radius:var(--radius-l); padding:.55rem .9rem; font:inherit; cursor:pointer; display:inline-flex; align-items:center; gap:.35rem; box-shadow:var(--shadow); transition:.25s background; }
.icon-btn:hover,.icon-btn:focus-visible { background:#e1d5ff; }
.icon-btn:active { transform:translateY(2px); }

.view-stack { flex:1; width:100%; max-width:760px; margin:0 auto; padding: .75rem clamp(.75rem,4vw,1.25rem) 4rem; }
.view { animation: fade .4s ease; }
@keyframes fade { from { opacity:0; transform:translateY(6px);} to { opacity:1; transform:translateY(0);} }

h1,h2,h3 { line-height:1.15; font-weight:600; letter-spacing:-.01em; }
p { line-height:1.5; }

.progress-cards { display:grid; grid-template-columns:repeat(auto-fit,minmax(140px,1fr)); gap:.75rem; margin: .5rem 0 1.25rem; }
.card { background:var(--bg-alt); border:1px solid var(--border); padding:.85rem .9rem; border-radius:var(--radius-m); box-shadow:var(--shadow); display:flex; flex-direction:column; gap:.15rem; min-height:90px; }
.card h3 { font-size:.8rem; text-transform:uppercase; letter-spacing:.08em; font-weight:600; margin:0; color:var(--text-dim); }
.card .big { font-size:1.55rem; font-weight:600; }
.card small { color:var(--text-dim); }

.quick-actions { display:flex; gap:.6rem; margin-bottom:1rem; }
button { font:inherit; cursor:pointer; }
.primary, .secondary, .danger, .outline { border-radius:var(--radius-l); padding:.9rem 1.2rem; font-weight:500; letter-spacing:.3px; font-size:.95rem; border:1px solid transparent; position:relative; }
.primary { background:var(--accent); color:#fff; box-shadow:var(--shadow); }
.primary:hover, .primary:focus-visible { filter:brightness(1.05); }
.primary:active { transform:translateY(2px); }
.primary.outline { background:var(--accent-soft); color:var(--accent); border-color:var(--accent); }
.secondary { background:var(--bg-alt); border:1px solid var(--border); color:var(--text-dim); }
.secondary:hover { background:#ece7f9; }
.secondary:active { transform:translateY(2px); }
.danger { background:var(--danger); color:#fff; }

.chip-row { display:flex; flex-wrap:wrap; gap:.5rem; }
.chip { --chip-bg: var(--bg-alt); background:var(--chip-bg); border:1px solid var(--border); padding:.55rem .85rem; border-radius:999px; font-size:.75rem; line-height:1; display:inline-flex; align-items:center; gap:.35rem; cursor:pointer; position:relative; }
.chip[data-weak="true"] { --chip-bg:#ffeef1; border-color:#ffd1d9; }
.chip.active { background:var(--accent); color:#fff; border-color:var(--accent); }
.chip small { opacity:.7; font-size:.65rem; }

.question-text { font-size:1.1rem; margin-top:.25rem; }
.options { list-style:none; margin:1.1rem 0 1.2rem; padding:0; display:flex; flex-direction:column; gap:.7rem; }
.option-btn { width:100%; text-align:left; background:var(--bg-alt); border:1px solid var(--border); padding: .85rem .9rem; border-radius:var(--radius-m); line-height:1.35; position:relative; display:flex; gap:.75rem; }
.option-btn:focus-visible { outline:2px solid var(--accent); outline-offset:2px; }
.option-btn.correct { border-color:#3b9d55; background:#e8f8ed; }
.option-btn.wrong { border-color:#c2363b; background:#ffecec; }
.option-btn.selected:not(.correct):not(.wrong) { border-color:var(--accent); background:#efe9ff; }

.answer-feedback { background:var(--bg-alt); border:1px solid var(--border); padding: .85rem 1rem; border-radius:var(--radius-m); box-shadow:var(--shadow); animation: pop .35s ease; }
@keyframes pop { from { opacity:0; transform:scale(.97);} to { opacity:1; transform:scale(1);} }
.answer-feedback h3 { margin:.1rem 0 .5rem; font-size:.9rem; text-transform:uppercase; letter-spacing:.07em; color:var(--text-dim); }
.answer-feedback .info { font-size:.8rem; color:var(--text-dim); line-height:1.45; }

.quiz-top-bar { display:flex; align-items:center; justify-content:space-between; gap:.5rem; margin-bottom:.7rem; }
.session-meta { font-size:.65rem; text-transform:uppercase; letter-spacing:.12em; font-weight:600; color:var(--text-dim); }
.question-progress { font-size:.8rem; font-weight:600; }

.quiz-actions { display:flex; gap:.6rem; }
.quiz-actions button { flex:1; }

.summary-stats { display:grid; gap:.75rem; grid-template-columns:repeat(auto-fit,minmax(150px,1fr)); margin: .75rem 0 1.25rem; }
.summary-stats .stat { background:var(--bg-alt); border:1px solid var(--border); padding:.75rem .85rem; border-radius:var(--radius-m); box-shadow:var(--shadow); }
.summary-stats h3 { margin:.15rem 0 .35rem; font-size:.75rem; text-transform:uppercase; letter-spacing:.08em; color:var(--text-dim); }
.summary-stats .value { font-size:1.3rem; font-weight:600; }
.review-list { display:flex; flex-direction:column; gap:.65rem; }
.review-item { background:var(--bg-alt); border:1px solid var(--border); border-radius:var(--radius-m); padding:.55rem .8rem .8rem; box-shadow:var(--shadow); }
.review-item[open] { background:#faf9ff; }
.review-item summary { list-style:none; cursor:pointer; font-weight:500; }
.review-item summary::-webkit-details-marker { display:none; }
.review-item .review-options { list-style:decimal; margin:.5rem 0 .4rem 1.1rem; padding:0; font-size:.75rem; display:flex; flex-direction:column; gap:.2rem; }
.review-item .review-info { font-size:.7rem; color:var(--text-dim); line-height:1.4; }
.review-item mark { background:#e3d7ff; color:inherit; padding:0 .25em; border-radius:4px; }

.custom-form { display:flex; flex-direction:column; gap:1rem; min-width:min(92vw,420px); }
.custom-form input[type=number] { width:100%; padding:.6rem .7rem; border:1px solid var(--border); border-radius:var(--radius-s); background:var(--bg-alt); font:inherit; }
.custom-form fieldset { border:1px solid var(--border); border-radius:var(--radius-m); padding:.85rem .9rem 1rem; display:flex; flex-direction:column; gap:.55rem; max-height:40dvh; overflow:auto; }
.checklist label { display:flex; align-items:center; gap:.6rem; font-size:.8rem; padding:.35rem .4rem; border-radius:var(--radius-s); cursor:pointer; }
.checklist label:hover { background:#efe9ff; }
.checklist input { width:1rem; height:1rem; }
.dialog-actions { display:flex; gap:.6rem; justify-content:flex-end; margin-top:.5rem; }

@media (hover:none) {
  .option-btn:active { transform:scale(.985); }
  .primary:active, .secondary:active { transform:translateY(2px); }
}

@media (min-width:680px) {
  .question-text { font-size:1.25rem; }
}

/* Scrollbar subtle styling */
* { scrollbar-width: thin; scrollbar-color: #c7bcdf transparent; }
*::-webkit-scrollbar { width:10px; }
*::-webkit-scrollbar-track { background:transparent; }
*::-webkit-scrollbar-thumb { background:#c7bcdf; border-radius:20px; border:2px solid #f6f4fb; }

.hidden { display:none !important; }
.loading { font-size:.75rem; letter-spacing:.08em; text-transform:uppercase; color:var(--text-dim); margin:.25rem 0 .5rem; }
.error-banner { background:#ffecec; border:1px solid #ffb4b4; color:#6a1a1a; padding:.7rem .85rem; border-radius:var(--radius-m); font-size:.8rem; margin:.6rem 0 1rem; }
